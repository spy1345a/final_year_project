<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
</head>
<body>

<h2>Dashboard</h2>

<p><b>Username:</b> {{ user.username }}</p>
<p><b>Role:</b> {{ user.role }}</p>

<hr>

<h3>Add Expense (AI Assisted)</h3>

<!-- STEP 1: Predict -->
<form method="POST">
    <input type="text" name="text" placeholder="Expense description" required>
    <input type="number" name="amount" placeholder="Amount ₹" required>

    <button name="action" value="predict" type="submit">
        Predict Category
    </button>
</form>

{% if prediction %}
<hr>

<h4>Prediction Result</h4>

<p>Description: <b>{{ cleaned_text }}</b></p>

<form method="POST">

    <input type="hidden" name="description" value="{{ cleaned_text }}">
    <input type="hidden" name="amount" value="{{ request.form.amount }}">

    <!-- CATEGORY DROPDOWN -->
    <label><b>Select Category:</b></label>
    <select name="category" required>

        {% for category in categories %}
            <option value="{{ category }}"
                {% if category == prediction %}
                    selected
                {% endif %}
            >
                {{ category }}
            </option>
        {% endfor %}

    </select>

    <br><br>

    <button name="action" value="confirm" type="submit">
        ✅ Confirm & Save Expense
    </button>

</form>

{% endif %}

<hr>

<a href="/expenses">View Expenses</a>
<a href="/users">View Users</a>
<a href="/logout">Logout</a>

</body>
</html>